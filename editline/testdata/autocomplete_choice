run
reset
resize 40 10
set_autocomplete_2
----
TEA WINDOW SIZE: {40 10}
-- view:
> [7m [0m                                   â¤
M-? toggle key help â€¢ C-d erase/stopğŸ›‡

# No context brings up full completion menu.
run
key tab
----
TEA PRINT: {We're matching ""!}
-- view:
[;mnames[0m        â¤
 Alice       â¤
 Amanda      â¤
 Amy         â¤
 Andrew      â¤
             â¤
  1/25       â¤
(entry "Alice" has no description)â¤
> [7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# If we press "/" during the menu, a filter comes up.
run
key /
----
-- view:
Filter: [7m [0m    â¤
 Alice       â¤
 Amanda      â¤
 Amy         â¤
 Andrew      â¤
             â¤
  1/25       â¤
(entry "Alice" has no description)â¤
> [7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# Entering text at the filter filters down the list.
run
type thur
----
-- view:
Filter: hur[7m [0m â¤
 Arthur      â¤
             â¤
             â¤
             â¤
             â¤
             â¤
(entry "Arthur" has no description)â¤
> [7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# Pressing enter makes the filter disappear and
# keeps the selection.
run
enter
----
-- view:
[;mnames[0m        â¤
 Arthur      â¤
             â¤
             â¤
             â¤
             â¤
             â¤
(entry "Arthur" has no description)â¤
> [7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# If we press enter during the menu, this selects
# the current entry.
run
key enter
----
-- view:
> Arthur [7m [0m                            â¤
M-? toggle key help â€¢ C-d erase/stopğŸ›‡

# Verify that if no entry is selected, nothing bad happens
# (regression test for an earlier display bug)
run
key tab
key /
type invalid
----
TEA PRINT: {We're matching ""!}
-- view:
Filter: lid[7m [0mâ¤
            â¤
            â¤
            â¤
            â¤
            â¤
            â¤
(no entry seleted)â¤
> Arthur [7m [0m                            â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# With a prefix, the completion list is pre-filtered.
run
reset
type b
key tab
----
TEA PRINT: {We're matching "B"!}
-- view:
[;mnames[0m â€¦  â¤
 Barbara â¤
 Betty   â¤
 Brenda  â¤
 Brian   â¤
         â¤
         â¤
(entry "Barbara" has no description)â¤
> B[7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# We can hide/show more key help.
run
key alt+?
----
-- view:
[;mnames[0m â€¦  â¤
 Barbara â¤
 Betty   â¤
 Brenda  â¤
 Brian   â¤
         â¤
         â¤
(entry "Barbara" has no description)â¤
> B[7m [0m                                   â¤
â†’/M-n         next column     â¤
â†/M-p         prev column     â¤
C-j/enter/tab accept          â¤
C-c           close/cancel    ğŸ›‡


run
key alt+?
----
-- view:
[;mnames[0m â€¦  â¤
 Barbara â¤
 Betty   â¤
 Brenda  â¤
 Brian   â¤
         â¤
         â¤
(entry "Barbara" has no description)â¤
> B[7m [0m                                   â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# Completion is canceled without input upon ctrl+c.
run
key ctrl+c
----
-- view:
> B[7m [0m                                   â¤
M-? toggle key help â€¢ C-d erase/stopğŸ›‡

# If the pre-filtered list of completions contains a prefix longer
# than the current input, that prefix is pre-entered even as the
# completion list is displayed.
run
reset
type chr
key tab
----
TEA PRINT: {We're matching "Chr"!}
-- view:
[;mnames[0m        â¤
 Christine   â¤
 Christopher â¤
             â¤
             â¤
(entry "Christine" has no description)â¤
> Christ[7m [0m                              â¤
M-? toggle key help â€¢ C-c close/cancelğŸ›‡

# After a completion is selected, it appends to the pre-filled prefix.
run
key down
key enter
----
-- view:
> Christopher [7m [0m                        â¤
M-? toggle key help â€¢ C-d erase/stopğŸ›‡

# That prefilled common prefix is also preserved when ctrl+c is
# pressed.
run
reset
type chr
key tab
key ctrl+c
----
TEA PRINT: {We're matching "Chr"!}
-- view:
> Christ[7m [0m                              â¤
M-? toggle key help â€¢ C-d erase/stopğŸ›‡
