run
reset
resize 40 25
----
TEA WINDOW SIZE: {40 25}
-- view:
[40m[37m> [0m[0m[40m[0m[40m[7m [0m[0m[40m[0m[40m                                   [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá

# By default, the "enter" key terminates the input.
run observe=(view,value)
enter hello world
noop
----
TEA QUIT
-- view:
[37m[37m> [0m[0m[37mhello world[0m[37m[37m [0m[0m[37m[0m[37m                        [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá
-- value:
"hello world"

# If we configure a function to check the end of the input and the end
# of the input is not reached, then the enter key introduces a
# newline.
run
reset
configure_check_eof
enter hello world
enter more text
----
-- view:
[37m> [0mhello world                          ‚ê§
[37m  [0mmore text                            ‚ê§
[40m[37m  [0m[0m[40m[0m[40m[7m [0m[0m[40m[0m[40m                                    [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá

# However, if the text finally contains the end-of-input condition,
# the enter key will terminate input again.
run observe=(view,value)
enter this is the end.
noop
----
TEA QUIT
-- view:
[37m[37m> [0m[0m[37mhello world [0m[37m                         [0m‚ê§
[37m[37m  [0m[0m[37mmore text [0m[37m                           [0m‚ê§
[37m[37m  [0m[0m[37mthis is the end.[0m[37m[37m [0m[0m[37m[0m[37m                    [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá
-- value:
"hello world\nmore text\nthis is the end."

# While the condition function is active, ctrl+o forces a newline even
# when the condition is met.
run
reset
type hello world.
key ctrl+o
type more text
----
-- view:
[37m> [0mhello world.                         ‚ê§
[40m[37m  [0m[0m[40mmore text[0m[40m[7m [0m[0m[40m[0m[40m                           [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá

# However then a regular enter will still terminate the input.
run observe=(view,value)
enter
noop
----
TEA QUIT
-- view:
[37m[37m> [0m[0m[37mhello world. [0m[37m                        [0m‚ê§
[37m[37m  [0m[0m[37mmore text[0m[37m[37m [0m[0m[37m[0m[37m                           [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá
-- value:
"hello world.\nmore text"

# If the end-of-input condition is not met, the enter key adds a
# newline. In that situation, it's still possible to force
# end-of-input with the "always complete" key, by default alt+enter.
run observe=(view,value)
reset
enter hello world
enter more text
type blah
key alt+enter
noop
----
TEA QUIT
-- view:
[37m[37m> [0m[0m[37mhello world [0m[37m                         [0m‚ê§
[37m[37m  [0m[0m[37mmore text [0m[37m                           [0m‚ê§
[37m[37m  [0m[0m[37mblah[0m[37m[37m [0m[0m[37m[0m[37m                                [0m‚ê§
[90mM-?[0m [90mtoggle key help[0m[90m ‚Ä¢ [0m[90mC-d[0m [90merase/stop[0m[90m ‚Ä¢ [0m[90mC-c[0m [90mclear/cancel[0m[90m ‚Ä¢ [0m[90mM-.[0m [90mhide/show prompt[0müõá
-- value:
"hello world\nmore text\nblah"
